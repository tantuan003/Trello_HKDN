<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Boards | Teamhub</title>

  <!-- CSS -->
  <link rel="stylesheet" href="/css/layout.css">
  <link rel="stylesheet" href="/css/board.css">
</head>
<body>
  <div class="app" id="app">
    <!-- Sidebar + Header sẽ được nạp động -->
    <div data-include="/layout.html"></div>

    <!-- Nội dung chính -->
    <div id="page-content" class="main">
      <!-- Đây là nơi nạp nội dung riêng từng trang -->
    </div>
  </div>

  <script>
    // Load layout chung + kích hoạt sidebar
    (async function includePartials() {
      const includes = document.querySelectorAll('[data-include]');
      for (const el of includes) {
        const url = el.getAttribute('data-include');
        if (!url) continue;
        try {
          const html = await fetch(url, {cache:'no-store'}).then(r => r.text());
          el.outerHTML = html;
        } catch (e) { console.error('Load partial failed:', url, e); }
      }

      // Sau khi sidebar đã được chèn → kích hoạt behavior
      initSidebarBehavior();
    })();

    function initSidebarBehavior(){
      document.querySelectorAll('.ws-main').forEach(btn => {
        btn.addEventListener('click', () => {
          const ws = btn.closest('.workspace');
          ws.querySelector('.ws-submenu').classList.toggle('hidden');
          btn.classList.toggle('opened');
        });
      });

      const current = location.pathname.split('/').pop() || 'boards.html';
      document.querySelectorAll('.side-item, .side-subitem').forEach(a => {
        const href = a.getAttribute('href');
        a.classList.toggle('is-active', href === current);
      });
    }

    // Ví dụ nạp nội dung riêng của trang
    async function loadBoardContent() {
      const content = `
        <div class="top-actions">
          <a class="pill is-active" href="boards.html">Boards</a>
          <a class="pill" href="members.html">Members</a>
          <a class="pill" href="settings.html">Settings</a>
        </div>

        <section class="section">
          <h3>Recently viewed</h3>
          <div class="board-grid">
            <div class="board-card">
              <div class="board-thumb"></div>
              <p class="board-title">My Teamhub board</p>
            </div>
          </div>
        </section>
      `;
      document.getElementById('page-content').innerHTML = content;
    }

    // Gọi load nội dung cho board
    loadBoardContent();
  </script>
</body>
</html>
