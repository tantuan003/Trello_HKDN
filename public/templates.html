<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Templates</title>

  <!-- CSS chung (header + sidebar) -->
  <link rel="stylesheet" href="./css/sidebar_header.css?v=1" />
  <!-- CSS riêng cho trang Templates -->
  <link rel="stylesheet" href="./css/templates.css?v=1" />
</head>
<body>
  <!-- Header + Sidebar sẽ được inject vào đây (giống boards.html) -->
  <div id="app-shell"></div>

  <!-- NỘI DUNG CHÍNH: Template gallery -->
  <main class="content content-templates">
    <div class="template-bar">
      <h3 class="template-title">Template gallery</h3>

      <label class="template-search">
        <input id="templateSearch" type="search" placeholder="Find template" />
        <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
          <circle cx="11" cy="11" r="7" fill="none" stroke="currentColor" stroke-width="2"></circle>
          <path d="M20 20L17 17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
        </svg>
      </label>
    </div>

    <section class="template-grid" id="templateGrid">
      <!-- Card theo ảnh mẫu -->
      <article class="template-card">
        <div class="template-card__title">Start with a blank board</div>
      </article>
    </section>
  </main>

  <script>
    // Inject component dùng lại cách như boards.html
    async function inject(file, targetSelector) {
      try {
        const res = await fetch(file, { cache: 'no-store' });
        if (!res.ok) throw new Error(res.status + ' ' + res.statusText);
        const html = await res.text();
        document.querySelector(targetSelector).innerHTML = html;
      } catch (err) {
        console.error('Load component failed:', file, err);
      }
    }

    // Đánh dấu menu Templates active & mở submenu
    function activateTemplatesMenu() {
      const head = document.getElementById('templateMenu');
      if (head) {
        head.classList.add('is-active','active');
        const section = head.closest('.nav-section');
        section?.classList.add('open');
      }
    }

    document.addEventListener('DOMContentLoaded', async () => {
      // templates.html ở /public → component ở ./components/...
      await inject('./components/sidebar_header.html', '#app-shell');
      activateTemplatesMenu();
    });

    // Toggle Workspace (dùng lại class trong sidebar_header.css)
    document.addEventListener('click', function (e) {
      const head = e.target.closest('.wsp-head');
      if (!head) return;
      const workspace = head.closest('.workspaces');
      workspace.classList.toggle('is-collapsed');
    });

    // Tìm kiếm (ẩn/hiện card theo từ khoá)
    document.addEventListener('input', (e) => {
      if (e.target.id !== 'templateSearch') return;
      const q = e.target.value.toLowerCase();
      document.querySelectorAll('#templateGrid .template-card').forEach(card => {
        card.style.display = card.textContent.toLowerCase().includes(q) ? '' : 'none';
      });
    });
  </script>
</body>
</html>
